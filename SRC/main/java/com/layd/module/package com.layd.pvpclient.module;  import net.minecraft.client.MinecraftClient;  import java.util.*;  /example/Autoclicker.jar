package com.layd.pvpclient.module.example;

import com.layd.pvpclient.module.Module;
import net.minecraft.client.MinecraftClient;
import net.minecraft.text.LiteralText;

/**
 * Минимальный AutoClicker модуль (демо).
 * Включается/выключается через API (в будущем — keybind).
 */
public class AutoClickerModule implements Module {
    private boolean enabled = false;
    private int cps = 8;
    private long lastTime = 0;

    @Override
    public String getId() { return "autoclicker"; }

    @Override
    public String getName() { return "AutoClicker"; }

    @Override
    public void onEnable() {
        enabled = true;
    }

    @Override
    public void onDisable() {
        enabled = false;
    }

    @Override
    public void tick(MinecraftClient client) {
        if (!enabled || client.player == null) return;

        long interval = 1000L / Math.max(1, cps);
        long now = System.currentTimeMillis();
        if (now - lastTime >= interval) {
            // простая имитация клика: swingHand и попытка послать локальную атаку если цель есть
            try {
                if (client.crosshairTarget != null && client.crosshairTarget.getType() == net.minecraft.util.hit.HitResult.Type.ENTITY) {
                    if (client.interactionManager != null && client.crosshairTarget instanceof net.minecraft.entity.EntityHitResult) {
                        net.minecraft.entity.Entity target = ((net.minecraft.entity.EntityHitResult) client.crosshairTarget).getEntity();
                        client.interactionManager.attackEntity(client.player, target);
                    }
                } else {
                    client.player.swingHand(net.minecraft.util.Hand.MAIN_HAND);
                }
            } catch (Throwable t) {
                t.printStackTrace();
            }
            lastTime = now;
        }
    }

    @Override
    public boolean isEnabled() { return enabled; }

    @Override
    public void setEnabled(boolean enabled) { this.enabled = enabled; }
}
